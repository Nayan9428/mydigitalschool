<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <title>Professional School Letterhead Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Vadodara:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --banner-bg: #1e3a8a; --name-color: #ffffff; --text-color: #ffffff; }
        body { font-family: 'Hind Vadodara', sans-serif; background: #f0f2f5; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .page-title { font-size: 26px; font-weight: 800; color: #1e3a8a; margin-bottom: 20px; border-bottom: 3px solid #1e3a8a; }

        .admin-panel { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 25px; width: 100%; max-width: 1000px; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: 600; font-size: 13px; color: #444; margin-bottom: 3px; }
        .input-group input, .input-group textarea, .input-group select { padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-family: 'Hind Vadodara'; }
        
        .color-section { grid-column: span 4; display: flex; gap: 15px; background: #f9f9f9; padding: 10px; border-radius: 8px; justify-content: center; border: 1px solid #eee; }
        .big-text { grid-column: span 4; }

        #letterhead { background: white; width: 210mm; height: 297mm; box-sizing: border-box; box-shadow: 0 0 30px rgba(0,0,0,0.2); position: relative; display: flex; flex-direction: column; overflow: hidden; }

        /* Watermark Styles */
        .watermark-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 0; /* рк▓ркЦрк╛ркгркирлА рккрк╛ркЫрк│ */
            pointer-events: none;
            width: 50%;
            display: flex; justify-content: center; align-items: center;
        }
        .watermark-img { width: 100%; height: auto; object-fit: contain; opacity: 0.1; }

        /* Content Styling to sit above watermark */
        .header-box, .ref-date-row, .content-area, .sig-container, .footer-banner { position: relative; z-index: 1; }

        .header-box { background: var(--banner-bg); color: var(--text-color); padding: 5px 50px 15px 50px; text-align: center; }
        .top-tag-line { font-size: 16px; font-weight: 500; margin-bottom: 5px; }
        .header-main { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .logo-img { width: 90px; height: 90px; object-fit: contain; background: white; border-radius: 50%; padding: 3px; }
        .school-info { flex-grow: 1; text-align: center; }
        .school-name-h1 { margin: 0; font-size: 38px; color: var(--name-color); font-weight: 800; line-height: 1; }
        .school-loc-p { margin: 2px 0; font-size: 17px; opacity: 1; }
        .details-grid { display: grid; grid-template-columns: 1fr 1fr; font-size: 14px; color: var(--text-color); line-height: 1.4; }

        .ref-date-row { display: flex; justify-content: space-between; margin: 15px 50px 5px 50px; font-size: 18px; font-weight: 700; color: #333; }
        .content-area { flex-grow: 1; padding: 10px 60px; font-size: 18px; line-height: 1.6; white-space: pre-wrap; color: #000; text-align: justify; }

        .sig-container { display: flex; flex-direction: column; align-items: flex-end; margin-right: 60px; margin-bottom: 30px; }
        .sig-display { width: 140px; height: 60px; object-fit: contain; display: none; margin-bottom: 5px; }
        .sig-label { font-size: 17px; font-weight: 700; border-top: 1px solid #333; width: 160px; text-align: center; padding-top: 4px; }

        .footer-banner { background: var(--banner-bg); color: var(--text-color); padding: 10px; text-align: center; font-size: 14px; }
        .btn-save { grid-column: span 4; padding: 15px; background: #16a34a; color: white; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; font-weight: 700; }
    </style>
</head>
<body>

<div class="page-title">ЁЯОирк╢рк╛рк│рк╛ркирлБркВ рк▓рлЗркЯрк░ рккрлЗркб ркмркирк╛рк╡рлЛ (рк╣рк░рлНрк╖рк┐рк▓ ркжрк░ркЬрлА)</div>

<div class="admin-panel">
    <div class="color-section">
        <div class="input-group"><label>рккркЯрлНркЯрлАркирлЛ рк░ркВркЧ:</label><input type="color" id="in-bg" value="#1e3a8a" oninput="update()"></div>
        <div class="input-group"><label>ркирк╛ркоркирлЛ рк░ркВркЧ:</label><input type="color" id="in-name-c" value="#ffffff" oninput="update()"></div>
        <div class="input-group"><label>рк▓ркЦрк╛ркгркирлЛ рк░ркВркЧ:</label><input type="color" id="in-txt-c" value="#ffffff" oninput="update()"></div>
    </div>

    <div class="input-group big-text"><label>ркЯрлЛркк рк╣рлЗркбрк┐ркВркЧ:</label><input type="text" id="in-tag" value="ркЬрк┐рк▓рлНрк▓рк╛ рккркВркЪрк╛ркпркд рк╢рк┐ркХрлНрк╖ркг рк╕ркорк┐ркдрк┐ рк╕ркВркЪрк╛рк▓рк┐ркд" oninput="update()"></div>
    <div class="input-group"><label>рк╢рк╛рк│рк╛ркирлБркВ ркирк╛рко:</label><input type="text" id="in-name" oninput="update()"></div>
    <div class="input-group"><label>ркдрк╛рк▓рлБркХрлЛ:</label><input type="text" id="in-tal" oninput="update()"></div>
    <div class="input-group"><label>ркЬрк┐рк▓рлНрк▓рлЛ:</label><input type="text" id="in-dist" oninput="update()"></div>
    <div class="input-group"><label>ркбрк╛ркпрк╕ ркХрлЛркб:</label><input type="text" id="in-dice" oninput="update()"></div>
    <div class="input-group"><label>рк╕рлНркерк╛рккркирк╛ ркдрк╛рк░рлАркЦ:</label><input type="text" id="in-est" oninput="update()"></div>
    <div class="input-group"><label>ркорлЛркмрк╛ркИрк▓:</label><input type="text" id="in-mo" oninput="update()"></div>
    <div class="input-group"><label>ркЗркорлЗркЗрк▓ ID:</label><input type="text" id="in-mail" oninput="update()"></div>
    <div class="input-group"><label>ркЬрк╛рк╡ркХ ркиркВркмрк░:</label><input type="text" id="in-jnum" oninput="update()"></div>
    <div class="input-group"><label>ркдрк╛рк░рлАркЦ (DD-MM-YYYY):</label><input type="date" id="in-date" oninput="update()"></div>
    
    <div class="input-group"><label>ркорлБркЦрлНркп рк▓рлЛркЧрлЛ:</label><input type="file" accept="image/*" onchange="loadImg(event, 'out-logo')"></div>
    
    <div class="input-group"><label>рк╡рлЛркЯрк░ркорк╛рк░рлНркХ рк▓рлЛркЧрлЛ:</label><input type="file" accept="image/*" onchange="loadImg(event, 'out-watermark')"></div>
    <div class="input-group"><label>рк╡рлЛркЯрк░ркорк╛рк░рлНркХ рккрк╛рк░ркжрк░рлНрк╢рк┐ркдрк╛:</label>
        <input type="range" id="in-opacity" min="0" max="0.5" step="0.01" value="0.1" oninput="update()">
    </div>

    <div class="input-group"><label>ркЖркЪрк╛рк░рлНркп рк╕рк╣рлА:</label><input type="file" accept="image/*" onchange="loadImg(event, 'out-sig')"></div>
    <div class="input-group big-text"><label>рккркдрлНрк░ркирлБркВ рк▓ркЦрк╛ркг:</label><textarea id="in-content" rows="3" oninput="update()"></textarea></div>
    <div class="input-group big-text"><label>рклрлВркЯрк░ рк╕рк░ркирк╛ркорлБркВ:</label><input type="text" id="in-foot" oninput="update()"></div>

    <button class="btn-save" onclick="saveImage()">рк▓рлЗркЯрк░рккрлЗркб рк╕рлЗрк╡ ркХрк░рлЛ (Download)</button>
</div>

<div id="letterhead">
    <div class="watermark-container">
        <img id="out-watermark" class="watermark-img" src="">
    </div>

    <div class="header-box">
        <div class="top-tag-line" id="out-tag">ркЬрк┐рк▓рлНрк▓рк╛ рккркВркЪрк╛ркпркд рк╢рк┐ркХрлНрк╖ркг рк╕ркорк┐ркдрк┐ рк╕ркВркЪрк╛рк▓рк┐ркд</div>
        <div class="header-main">
            <img id="out-logo" class="logo-img" src="https://via.placeholder.com/95?text=LOGO">
            <div class="school-info">
                <h1 id="out-name" class="school-name-h1">рк╢рлНрк░рлА рк╕рк░ркХрк╛рк░рлА рккрлНрк░рк╛ркеркорк┐ркХ рк╢рк╛рк│рк╛</h1>
                <p class="school-loc-p">ркдрк╛рк▓рлБркХрлЛ: <span id="out-tal">______</span>, ркЬрк┐рк▓рлНрк▓рлЛ: <span id="out-dist">______</span></p>
            </div>
            <div style="width:90px"></div>
        </div>
        <div class="details-grid">
            <div style="text-align: left;">
                <b>ркбрк╛ркпрк╕ ркХрлЛркб :</b> <span id="out-dice">----------</span><br>
                <b>рк╕рлНркерк╛рккркирк╛ ркдрк╛рк░рлАркЦ :</b> <span id="out-est">----------</span>
            </div>
            <div style="text-align: right;">
                <b>ркорлЛркмрк╛ркИрк▓ ркиркВ. :</b> <span id="out-mo">----------</span><br>
                <b>ркЗтАУркорлЗркЗрк▓ :</b> <span id="out-mail">----------</span>
            </div>
        </div>
    </div>

    <div class="ref-date-row">
        <div>ркЬрк╛рк╡ркХ ркиркВркмрк░ : <span id="out-jnum">__________</span></div>
        <div>ркдрк╛рк░рлАркЦ : <span id="out-date">____-____-_______</span></div>
    </div>

    <div class="content-area" id="out-content"></div>

    <div class="sig-container">
        <img id="out-sig" class="sig-display">
        <div class="sig-label">ркЖркЪрк╛рк░рлНркпрк╢рлНрк░рлАркирлА рк╕рк╣рлА</div>
    </div>

    <div class="footer-banner" id="out-foot">рк╢рк╛рк│рк╛ркирлБркВ рк╕рк░ркирк╛ркорлБркВ ркЕрк╣рлАркВ ркжрлЗркЦрк╛рк╢рлЗ</div>
</div>

<script>
    function update() {
        document.documentElement.style.setProperty('--banner-bg', document.getElementById('in-bg').value);
        document.documentElement.style.setProperty('--name-color', document.getElementById('in-name-c').value);
        document.documentElement.style.setProperty('--text-color', document.getElementById('in-txt-c').value);

        document.getElementById('out-tag').innerText = document.getElementById('in-tag').value;
        document.getElementById('out-name').innerText = document.getElementById('in-name').value || "рк╢рлНрк░рлА рк╕рк░ркХрк╛рк░рлА рккрлНрк░рк╛ркеркорк┐ркХ рк╢рк╛рк│рк╛";
        document.getElementById('out-tal').innerText = document.getElementById('in-tal').value || "______";
        document.getElementById('out-dist').innerText = document.getElementById('in-dist').value || "______";
        document.getElementById('out-dice').innerText = document.getElementById('in-dice').value || "----------";
        document.getElementById('out-est').innerText = document.getElementById('in-est').value || "----------";
        document.getElementById('out-mo').innerText = document.getElementById('in-mo').value || "----------";
        document.getElementById('out-mail').innerText = document.getElementById('in-mail').value || "----------";
        document.getElementById('out-jnum').innerText = document.getElementById('in-jnum').value || "__________";
        document.getElementById('out-content').innerText = document.getElementById('in-content').value;
        document.getElementById('out-foot').innerText = document.getElementById('in-foot').value || "рк╢рк╛рк│рк╛ркирлБркВ рк╕рк░ркирк╛ркорлБркВ ркЕрк╣рлАркВ ркжрлЗркЦрк╛рк╢рлЗ";

        // Watermark Opacity Update
        const opacityVal = document.getElementById('in-opacity').value;
        document.getElementById('out-watermark').style.opacity = opacityVal;

        const dVal = document.getElementById('in-date').value;
        if(dVal) {
            const d = new Date(dVal);
            const day = String(d.getDate()).padStart(2, '0');
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const year = d.getFullYear();
            document.getElementById('out-date').innerText = `${day}-${month}-${year}`;
        }
    }

    function loadImg(e, id) {
        const file = e.target.files[0];
        if (file) {
            const img = document.getElementById(id);
            img.src = URL.createObjectURL(file);
            if(id === 'out-sig') img.style.display = 'block';
        }
    }

    function saveImage() {
        html2canvas(document.getElementById('letterhead'), { scale: 3 }).then(canvas => {
            let link = document.createElement('a');
            link.download = 'School_Letterhead_Final.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }
</script>

</body>
</html>
